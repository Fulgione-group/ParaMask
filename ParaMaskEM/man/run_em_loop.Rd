% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_em_loop.R
\name{run_em_loop}
\alias{run_em_loop}
\title{Run EM loop for ParaMaskEM}
\usage{
run_em_loop(
  regData2,
  predDF,
  fit,
  coef_fit,
  offsetfit,
  weight1,
  weight2,
  maxiter = 100,
  boundfit = FALSE,
  lboundary = NULL,
  uboundary = NULL,
  tolerance = 0.001,
  verbose = FALSE
)
}
\arguments{
\item{regData2}{Data frame used for modeling (Z, MAF, het, N).}

\item{predDF}{Data frame used for prediction (contains MAF and Z).}

\item{fit}{Initial VGAM model fit.}

\item{coef_fit}{Initial coefficients from model fit.}

\item{offsetfit}{Logical: was the initial model fit using a fixed offset?}

\item{weight1}{Vector of initial weights for class K.}

\item{weight2}{Vector of initial weights for class D.}

\item{maxiter}{Maximum number of EM iterations.}

\item{boundfit}{Logical: whether to enforce slope boundaries.}

\item{lboundary}{Lower slope boundary.}

\item{uboundary}{Upper slope boundary.}

\item{tolerance}{Convergence threshold.}

\item{verbose}{Print progress?}
}
\value{
A list with the final fit, coefficients, log-likelihood, and offsetfit status.
}
\description{
Iteratively refits the VGAM model using updated class weights until convergence.
}
